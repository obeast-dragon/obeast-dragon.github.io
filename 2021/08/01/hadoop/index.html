<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="hadoop学习, 社畜老龙的黄金屋">
    <meta name="description" content="一、Hadoop的概述
1、Hadoop组成部分
hadoop2.0以后的四个模块:

Hadoop Common : Hadoop模块的通用组件
Hadoop Distributed File system:分布式文件系统- Hadoop">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>hadoop学习 | 社畜老龙的黄金屋</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">社畜老龙的黄金屋</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">社畜老龙的黄金屋</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/obeast-dragon" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #000000;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/obeast-dragon" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/9.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">hadoop学习</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/hadoop/">
                                <span class="chip bg-color">hadoop</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" class="post-category">
                                大数据
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-08-01
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2023-02-23
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    4.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    22 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1>一、Hadoop的概述</h1>
<h2 id="1、Hadoop组成部分">1、Hadoop组成部分</h2>
<p>hadoop2.0以后的四个模块:</p>
<ul>
<li>Hadoop Common : Hadoop模块的通用组件</li>
<li>Hadoop Distributed File system:分布式文件系统- Hadoop YARN:作业调度和资源管理框架王</li>
<li>Hadoop MapReduce:基于YARN的大型数据集并行计算处理框架</li>
</ul>
<p>hadoop3.0新扩展的两个模块:</p>
<ul>
<li>Hadoop 0zone : Hadoop的对象存储机制</li>
<li>Hadoop Submarine :Hadoop的机器学习引擎</li>
</ul>
<h2 id="2、Hadoop生态系统">2、Hadoop生态系统</h2>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513204533586.png" alt="image-20220513204533586"></p>
<h3 id="2-1、推荐系统架构图">2.1、推荐系统架构图</h3>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513204751010.png" alt="image-20220513204751010"></p>
<h1>二、Hadoop组件</h1>
<h2 id="1、HDFS">1、HDFS</h2>
<h3 id="1-1、NameNode-和-DataNode、Secondary-NameNode（2NN）">1.1、NameNode 和 DataNode、Secondary NameNode（2NN）</h3>
<ol>
<li>NameNode (nn):存储文件的元数据，如文件名，文件目录结构，文件属性（生成时间、副本数、文件权限)，以及每个文件的块列表和块所在的DataNode等。（目录）</li>
<li>DataNode(dn):在本地文件系统存储文件块数据，以及块数据的校验和。（数据）</li>
<li>Secondary NameNode(2nn):每隔一段时间对NameNode元数据备份。（备份目录）</li>
</ol>
<h2 id="2、YARN">2、YARN</h2>
<p>Yet Another Resource Negotiator简称YARN，另一种资源协调者，是Hadoop的资源管理器。</p>
<ol>
<li>ResourceManager (RM) :整个集群资源（内存、CPu等)的老大2)</li>
<li>NodeManager (NM):单个节点服务器资源老大</li>
<li>ApplicationMaster (AM):单个任务运行的老大</li>
<li>Container:容器，相当一台独立的服务器，里面封装了任务运行所需要的资源，如内存、CPU、磁盘、网络等。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513202103688.png" alt="image-20220513202103688"></p>
<h2 id="3、MapReduce">3、MapReduce</h2>
<p>MapReduce将计算过程分为两个阶段:</p>
<ol>
<li>Map 和 Reduce1)Map阶段并行处理输入数据</li>
<li>Reduce阶段对Map结果进行汇总</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513203611647.png" alt="image-20220513203611647"></p>
<h2 id="4、HDFS、YARN、MapReduce三者之间的关系">4、HDFS、YARN、MapReduce三者之间的关系</h2>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513204147827.png" alt="image-20220513204147827"></p>
<h1>三、Hadoop集群搭建</h1>
<h2 id="1、克隆虚拟机三台">1、克隆虚拟机三台</h2>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513220911960.png" alt="image-20220513220911960"></p>
<h3 id="1-1、配置网络">1.1、配置网络</h3>
<h4 id="1-1-1、配置虚拟机网络">1.1.1、配置虚拟机网络</h4>
<blockquote>
<p>注意：122可以是任意数字</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513230314292.png" alt="image-20220513230314292"></p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513230556348.png" alt="image-20220513230556348"></p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513230609592.png" alt="image-20220513230609592"></p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513230628135.png" alt="image-20220513230628135"></p>
<h3 id="2-1、修改ip和hostname、hosts">2.1、修改ip和hostname、hosts</h3>
<h4 id="2-1-1、修改IP">2.1.1、修改IP</h4>
<pre class="line-numbers language-none"><code class="language-none">vi /etc/sysconfig/network-scripts/ifcfg-ens33<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">TYPE=<span class="token string">"Ethernet"</span>
PROXY_METHOD=<span class="token string">"none"</span>
BROWSER_ONLY=<span class="token string">"no"</span>
#dhcp动态获取ip地址
#static静态的
BOOTPROTO=<span class="token string">"static"</span>
DEFROUTE=<span class="token string">"yes"</span>
IPV4_FAILURE_FATAL=<span class="token string">"no"</span>
IPV6INIT=<span class="token string">"yes"</span>
IPV6_AUTOCONF=<span class="token string">"yes"</span>
IPV6_DEFROUTE=<span class="token string">"yes"</span>
IPV6_FAILURE_FATAL=<span class="token string">"no"</span>
IPV6_ADDR_GEN_MODE=<span class="token string">"stable-privacy"</span>
NAME=<span class="token string">"ens33"</span>
UUID=<span class="token string">"9284b675-bfa4-426c-9d2e-e5af1549f1b2"</span>
DEVICE=<span class="token string">"ens33"</span>
ONBOOT=<span class="token string">"yes"</span>

#修改这个即可
#最后一个点之前看ifconfig
IPADDR=<span class="token number">192.168</span>.<span class="token number">122.102</span>
GATEWAY=<span class="token number">192.168</span>.<span class="token number">122.2</span>
DNS1=<span class="token number">192.168</span>.<span class="token number">122.2</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513230137233.png" alt="image-20220513230137233"></p>
<h4 id="2-1-2、修改Hostname">2.1.2、修改Hostname</h4>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">vim</span> /etc/hostname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513221409788.png" alt="image-20220513221409788"></p>
<h4 id="2-1-3、修改Hosts">2.1.3、修改Hosts</h4>
<pre class="line-numbers language-none"><code class="language-none">vim /etc/hosts<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6

192.168.122.102 hadoop102
192.168.122.103 hadoop103
192.168.122.104 hadoop104
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="3-1修改用户为root权限">3.1修改用户为root权限</h3>
<pre class="line-numbers language-none"><code class="language-none">vim /etc/sudoers<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514133839645.png" alt="image-20220514133839645"></p>
<h3 id="4-1、修改windows的主机映射文件（方便后期访问访问网站用域名）">4.1、修改windows的主机映射文件（方便后期访问访问网站用域名）</h3>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514164248830.png" alt="image-20220514164248830"></p>
<h3 id="5-1、重启">5.1、重启</h3>
<pre class="line-numbers language-none"><code class="language-none">reboot<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="2、安装jdk">2、安装jdk</h2>
<h3 id="2-1、把jdk解压到-opt-module">2.1、把jdk解压到/opt/module</h3>
<pre class="line-numbers language-none"><code class="language-none">tar -zxvf jdk-8u212-linux-x64.tar.gz -C /opt/ module/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513234641341.png" alt="image-20220513234641341"></p>
<h3 id="2-2、配置环境变量">2.2、配置环境变量</h3>
<blockquote>
<p>vim /etc/profile会遍历后缀文件所以可以新建文件</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220513234949287.png" alt="image-20220513234949287"></p>
<pre class="line-numbers language-none"><code class="language-none">cd /etc/profile.d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="2-2-1、新建my-env-sh文件配置环境变量">2.2.1、新建my_env.sh文件配置环境变量</h4>
<pre class="line-numbers language-none"><code class="language-none">vim my_env.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">#JAVA_HOME
export JAVA_HOME=/opt/module/jdk1.8.0_311
export PATH=$PATH:$JAVA_HOME/bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="2-2-2、重新加载profile">2.2.2、重新加载profile</h4>
<pre class="line-numbers language-none"><code class="language-none">source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="3、安装Hadoop">3、安装Hadoop</h2>
<h3 id="3-1、解压">3.1、解压</h3>
<pre class="line-numbers language-none"><code class="language-none">tar -zxvf jdk-8u212-linux-x64.tar.gz -C /opt/module<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="3-2、配置环境变量">3.2、配置环境变量</h3>
<h4 id="3-2-1、修改my-env-sh加上如下">3.2.1、修改my_env.sh加上如下</h4>
<pre class="line-numbers language-none"><code class="language-none">#HADOOP_HOME
export HADOOP_HOME=/opt/module/hadoop-3.3.2
export PATH=$PATH:$HADOOP_HOME/bin
export PATH=$PATH:$HADOOP_HOME/sbin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="3-2-2、重新加载">3.2.2、重新加载</h4>
<pre class="line-numbers language-none"><code class="language-none">source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="4、编写集群分发脚本">4、编写集群分发脚本</h2>
<h3 id="4-1、scp安全拷贝">4.1、scp安全拷贝</h3>
<p>(1）scp定义<br>
scp可以实现服务器与服务器之间的数据拷贝。（(from server1 to server2) (2）基本语法</p>
<blockquote>
<p>scp       -r      $pdir/$fname                       $user@$host:$pdir/$foame<br>
命令   递归     要拷贝的文件路径/名称       目的地用户@主机:目的地路径/名称-</p>
</blockquote>
<h4 id="4-1-2、在102拷贝jdk到103">4.1.2、在102拷贝jdk到103</h4>
<pre class="line-numbers language-none"><code class="language-none">scp -r jdk1.8.0_212/ wxl@hadoop103:/opt/module<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="4-1-2、在103拉取102的hadoop">4.1.2、在103拉取102的hadoop</h4>
<pre class="line-numbers language-none"><code class="language-none">scp -r wxl@hadoop102:/opt/module/hadoop-3.1.3 ./<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="4-2、rsync远程同步工具（效率高，只修改改变的部分）">4.2、rsync远程同步工具（效率高，只修改改变的部分）</h3>
<p>rsync主要用于备份和镜像。具有速度快、避免复制相同内容和支持符号链接的优点。rsync.和 scp 区别: 用rsync.做文件的复制要比scp的速度快，rsync,只对差异文件做更新。scp,是把所有文件都复制过去。</p>
<h4 id="4-2-1、基本语法">4.2.1、基本语法</h4>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514111948389.png" alt="image-20220514111948389"></p>
<h3 id="4-3、集群分发脚本">4.3、集群分发脚本</h3>
<p>（1）需求:循环复制文件到所有节点的相同目录下</p>
<h4 id="1-、在-home-wxl下创建可以不用配置环境变量">1)、在/home/wxl下创建可以不用配置环境变量</h4>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514113600089.png" alt="image-20220514113600089"></p>
<h4 id="2）、编写脚本xsync">2）、编写脚本xsync</h4>
<pre class="line-numbers language-bat" data-language="bat"><code class="language-bat">#!/bin/bash
#1. 判断参数个数
if [ $# -lt 1 ]
then
  echo Not Enough Arguement!
  exit;
fi

#2. 遍历集群所有机器
for host in hadoop102 hadoop103 hadoop104
do
    echo ====================  $host  ====================
    #3. 遍历所有目录，挨个发送

    for file in $@
    do
        #4. 判断文件是否存在
        if [ -e $file ]
            then
                #5. 获取父目录
                pdir=$(cd -P $(dirname $file); pwd)

                #6. 获取当前文件的名称
                fname=$(basename $file)
                ssh $host "mkdir -p $pdir"
                rsync -av $pdir/$fname $host:$pdir
            else
                echo $file does not exists!
        fi
    done
done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4）、修改权限">4）、修改权限</h4>
<pre class="line-numbers language-none"><code class="language-none">chmod 777 xsync<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="5）、配置环境变量my-env-sh">5）、配置环境变量my_env.sh</h4>
<pre class="line-numbers language-none"><code class="language-none">cd /etc/profile.d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">#WXL_HOME
export WXL_HOME=/home/wxl
export PATH=$PATH:$WXL_HOME/bin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="6-、重新加载">6)、重新加载</h4>
<pre class="line-numbers language-none"><code class="language-none">source /etc/profile<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="5、三种集群模式">5、三种集群模式</h2>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514010032489.png" alt="image-20220514010032489"></p>
<h3 id="5-1、本地测试">5.1、本地测试</h3>
<p>在/opt/module/hadoop-3.3.2创建文件夹</p>
<pre class="line-numbers language-none"><code class="language-none">mkdir wcinput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>创建文本word.txt</p>
<pre class="line-numbers language-none"><code class="language-none">aa
dd
dd
cc
c
cc
vv
#任意<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">cd /opt/module/hadoop-3.3.2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>统计测试</p>
<pre class="line-numbers language-none"><code class="language-none">bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.2.jar wordcount wcinput/ ./wcoutput

#输出路径不能存在<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514011317087.png" alt="image-20220514011317087"></p>
<h2 id="6、ssh免密登录">6、ssh免密登录</h2>
<h3 id="6-1、ssh原理">6.1、ssh原理</h3>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514143927653.png" alt="image-20220514143927653"></p>
<h3 id="6-2、具体操作">6.2、具体操作</h3>
<p>三次回车</p>
<pre class="line-numbers language-none"><code class="language-none">ssh-keygen -t rsa<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>拷贝公钥到自己、hadoop103、hadoop104</p>
<pre class="line-numbers language-none"><code class="language-none">ssh-copy-id hadoop102
ssh-copy-id hadoop103
ssh-copy-id hadoop104<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="7、集群配置">7、集群配置</h2>
<h3 id="7-1、集群规划">7.1、集群规划</h3>
<blockquote>
<p>注意:</p>
</blockquote>
<ul>
<li>NameNode和 SecondaryNameNode不要安装在同一台服务器</li>
<li>ResourceManager也很消耗内存，不要和NameNode、SecondaryNameNode配置在同一台机器上</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514152002773.png" alt="image-20220514152002773"></p>
<h3 id="7-2、配置文件说明">7.2、配置文件说明</h3>
<p>​	Hadoop配置文件分两类:默认配置文件和自定义配置文件，只有用户想修改某一默认配置值时，才需要修改自定义配置文件，更改相应属性值。</p>
<p>（1）默认配置文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514152127680.png" alt="image-20220514152127680"></p>
<p>（2）自定义配置文件</p>
<p>core-site.xml、hdfs-site.xml、yarn-site.xml、mapred-site.xml四个配置文件存放在<br>
$HADOOP_HOME/etc/hadoop,这个路径上，用户可以根据项目需求重新进行修改配置。</p>
<h3 id="7-3、修改配置">7.3、修改配置</h3>
<h4 id="1）core-site-xml">1）core-site.xml</h4>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token prolog">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span>
<span class="token comment">&lt;!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
--&gt;</span>

<span class="token comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 指定NameNode的地址 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://hadoop102:8020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 指定hadoop数据的存储目录 --&gt;</span>
  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hadoop.tmp.dir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/opt/module/hadoop-3.3.2/data<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="2）hdfs-site-xml">2）hdfs-site.xml</h4>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="token prolog">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span>
<span class="token comment">&lt;!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
--&gt;</span>

<span class="token comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- nn web端访问地址--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop102:9870<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 2nn web端访问地址--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>dfs.namenode.secondary.http-address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop104:9868<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="3）yarn-site-xml">3）yarn-site.xml</h4>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token comment">&lt;!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 指定MR走shuffle --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 指定ResourceManager的地址--&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop103<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 环境变量的继承 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.env-whitelist<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4）mapred-site-xml">4）mapred-site.xml</h4>
<pre class="line-numbers language-none"><code class="language-none">&lt;?xml version="1.0"?&gt;
&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;
&lt;!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
--&gt;

&lt;!-- Put site-specific property overrides in this file. --&gt;

&lt;configuration&gt;

  &lt;!-- 指定MapReduce程序运行在Yarn上 --&gt;
  &lt;property&gt;
    &lt;name&gt;mapreduce.framework.name&lt;/name&gt;
    &lt;value&gt;yarn&lt;/value&gt;
  &lt;/property&gt;

&lt;/configuration&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="5）分发配置">5）分发配置</h4>
<pre class="line-numbers language-none"><code class="language-none">xsync /opt/module/hadoop-3.3.2/etc/hadoop/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>如果不行切换root用户再次执行</p>
<pre class="line-numbers language-none"><code class="language-none">su root<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="6）配置workers">6）配置workers</h4>
<pre class="line-numbers language-none"><code class="language-none">cd /opt/module/hadoop-3.3.2/etc/hadoop<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>找到workers</p>
<pre class="line-numbers language-none"><code class="language-none">hadoop102
hadoop103
hadoop104<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h2 id="8、启动集群">8、启动集群</h2>
<h3 id="8-1、初始化">8.1、初始化</h3>
<p>(1）如果集群是第一次启动，需要在 hadoop102节点格式化 NameNode,(注意:格式化NameNode，会产生新的集群id，导致NameNode,和 DataNode,的集群id不一致，集群找不到已往数据。如果集群在运行过程中报错，需要重新格式化NameNode的话，一定要先停止 namenode,和 datanode进程，并且要删除所有机器的data和 logs目录，然后再进行格式化。)</p>
<pre class="line-numbers language-none"><code class="language-none">hdfs namenode -format<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="8-2、修改所有机器权限">8.2、修改所有机器权限</h4>
<pre class="line-numbers language-none"><code class="language-none">sudo chmod 777 /opt/module/hadoop-3.3.2/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="8-3、启动dfs在102">8.3、启动dfs在102</h4>
<p>用wxl用户开始</p>
<pre class="line-numbers language-none"><code class="language-none">sbin/start-dfs.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p>如果错；</p>
<p>1、结束</p>
<p>2、删除每个机器的logs和data文件</p>
<p>3、再次重新初始化</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">sbin/stop-yarn.sh
sbin/stop-dfs.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h5 id="成功">成功</h5>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514191640381.png" alt="image-20220514191640381"></p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514191634127.png" alt="image-20220514191634127"></p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514191627047.png" alt="image-20220514191627047"></p>
<p>hadoop102:9870或者192.168.122.102:9870</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514191542831.png" alt="image-20220514191542831"></p>
<h4 id="8-4、启动yarn在103">8.4、启动yarn在103</h4>
<pre class="line-numbers language-none"><code class="language-none">sbin/start-yarn.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514192355846.png" alt="image-20220514192355846"></p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514201516786.png" alt="image-20220514201516786"></p>
<h2 id="9、测试集群HDFS">9、测试集群HDFS</h2>
<h3 id="9-1、创建目录">9.1、创建目录</h3>
<pre class="line-numbers language-none"><code class="language-none">hadoop fs -mkdir /wcinput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514195440552.png" alt="image-20220514195440552"></p>
<h3 id="9-2、上传文件">9.2、上传文件</h3>
<pre class="line-numbers language-none"><code class="language-none">hadoop fs -put wcinput/word.txt /wcinput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514200753755.png" alt="image-20220514200753755"></p>
<h3 id="9-3、数据存储位置">9.3、数据存储位置</h3>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514201127910.png" alt="image-20220514201127910"></p>
<p>有三台副本分别在三台机器上</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514201240965.png" alt="image-20220514201240965"></p>
<h2 id="10、测试集群MapReduce">10、测试集群MapReduce</h2>
<blockquote>
<p>输入路径是HDFS上的路径不是本地的；输出也是</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.3.2.jar  wordcount /wcinput /wcoutput<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514202013826.png" alt="image-20220514202013826"></p>
<p>结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514202212059.png" alt="image-20220514202212059"></p>
<h2 id="11、配置MapReduce历史服务器">11、配置MapReduce历史服务器</h2>
<p>为了查看程序的历史运行情况，需要配置一下历史服务器。具体配置步骤如下:</p>
<h3 id="11-1、配置102的mapred-site-xml">11.1、配置102的mapred-site.xml</h3>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token prolog">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span>
<span class="token comment">&lt;!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
--&gt;</span>

<span class="token comment">&lt;!-- Put site-specific property overrides in this file. --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>

  <span class="token comment">&lt;!-- 指定MapReduce程序运行在Yarn上 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.framework.name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>yarn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- 历史服务器端地址 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop102:10020<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- 历史服务器 web 端地址 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>mapreduce.jobhistory.webapp.address<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop102:19888<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="11-2、切换root用户分发配置">11.2、切换root用户分发配置</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">su</span>

<span class="token builtin class-name">cd</span> /opt/module/hadoop-3.3.2/etc/hadoop

xsync mapred-site.xml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="11-3、重新启动yarn在（103）">11.3、重新启动yarn在（103）</h3>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sbin/stop-yarn.sh

sbin/start-yarn.sh

jps<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="11-4、启动历史服务器">11.4、启动历史服务器</h3>
<pre class="line-numbers language-none"><code class="language-none">bin/mapred  --daemon start historyserver<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514203943578.png" alt="image-20220514203943578"></p>
<h2 id="12、配置日志聚集功能">12、配置日志聚集功能</h2>
<p>日志聚集概念:应用运行完成以后，将程序运行日志信息上传到HDFS 系统上。</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514204956159.png" alt="image-20220514204956159"></p>
<p>日志聚集功能好处:可以方便的查看到程序运行详情，方便开发调试。</p>
<blockquote>
<p>注意:开启日志聚集功能，需要重新启动NodeManager ResourceManHistoryServer。</p>
</blockquote>
<p>开启日志聚集功能具体步骤如下:c</p>
<h3 id="12-1、配置yarn-site-xml">12.1、配置yarn-site.xml</h3>
<pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token prolog">&lt;?xml version="1.0"?&gt;</span>
<span class="token comment">&lt;!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
--&gt;</span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>

	<span class="token comment">&lt;!-- 指定MR走shuffle --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.aux-services<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>mapreduce_shuffle<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- 指定ResourceManager的地址--&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.resourcemanager.hostname<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop103<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- 环境变量的继承 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.nodemanager.env-whitelist<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>JAVA_HOME,HADOOP_COMMON_HOME,HADOOP_HDFS_HOME,HADOOP_CONF_DIR,CLASSPATH_PREPEND_DISTCACHE,HADOOP_YARN_HOME,HADOOP_MAPRED_HOME<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

  	<span class="token comment">&lt;!-- 开启日志聚集功能 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-aggregation-enable<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- 设置日志聚集服务器地址 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span> 
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log.server.url<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span> 
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>http://hadoop102:19888/jobhistory/logs<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
	
	<span class="token comment">&lt;!-- 设置日志保留时间为 7 天 --&gt;</span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>yarn.log-aggregation.retain-seconds<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
	 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>604800<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="12-2、配置分发">12.2、配置分发</h3>
<p>切换root</p>
<pre class="line-numbers language-none"><code class="language-none">[root@hadoop102 hadoop-3.3.2]# cd /opt/module/hadoop-3.3.2/etc/hadoop
[root@hadoop102 hadoop]# xsync yarn-site.xml<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="12-3、单节点停止">12.3、单节点停止</h3>
<h4 id="1）、停止historyserver">1）、停止historyserver</h4>
<pre class="line-numbers language-none"><code class="language-none">mapred --daemon stop historyserver<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514210043646.png" alt="image-20220514210043646"></p>
<pre class="line-numbers language-none"><code class="language-none">mapred --daemon start historyserver<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="2）、停止yarn并重启">2）、停止yarn并重启</h4>
<pre class="line-numbers language-none"><code class="language-none">sbin/stop-yarn.sh

sbin/start-yarn.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>测试结果</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514210916046.png" alt="image-20220514210916046"></p>
<h2 id="13、集群启动-停止方式总结">13、集群启动/停止方式总结</h2>
<h3 id="13-1、各个模块分开启动-停止（配置ssh是前提）常用">13.1、各个模块分开启动/停止（配置ssh是前提）常用</h3>
<p>​	(1）整体启动/停止HDFS<br>
​</p>
<pre class="line-numbers language-none"><code class="language-none">start-dfs.sh/stop-dfs.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>​	(2）整体启动/停止YARN</p>
<pre class="line-numbers language-none"><code class="language-none">start-yarn.sh/stop-yarn.shel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="13-2、各个服务组件逐一启动-停止">13.2、各个服务组件逐一启动/停止</h3>
<p>(1）分别启动/停止HDFS组件</p>
<pre class="line-numbers language-none"><code class="language-none">hdfs --daemon start/stop namenode /datanode/secondarynamenode<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>(2）启动/停止YARN</p>
<pre class="line-numbers language-none"><code class="language-none">yarn --daemon start/stop resourcemanager/nodemanager<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="13-3、集群一起启动脚本">13.3、集群一起启动脚本</h3>
<p>创建脚本到</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514221717361.png" alt="image-20220514221717361"></p>
<pre class="line-numbers language-bat" data-language="bat"><code class="language-bat">#!/bin/bash

if [ $# -lt 1 ]

then
  echo "No Args Input..."
  exit ;
fi

case $1 in
"start")

    echo " =================== 启动 hadoop集群 ==================="

 

    echo " --------------- 启动 hdfs ---------------"

    ssh hadoop102 "/opt/module/hadoop-3.3.2/sbin/start-dfs.sh"

    echo " --------------- 启动 yarn ---------------"

    ssh hadoop103 "/opt/module/hadoop-3.3.2/sbin/start-yarn.sh"

    echo " --------------- 启动 historyserver ---------------"

    ssh hadoop102 "/opt/module/hadoop-3.3.2/bin/mapred --daemon start historyserver"

;;

"stop")

    echo " =================== 关闭 hadoop集群 ==================="

 

    echo " --------------- 关闭 historyserver ---------------"

    ssh hadoop102 "/opt/module/hadoop-3.3.2/bin/mapred --daemon stop historyserver"

    echo " --------------- 关闭 yarn ---------------"

    ssh hadoop103 "/opt/module/hadoop-3.3.2/sbin/stop-yarn.sh"

    echo " --------------- 关闭 hdfs ---------------"

    ssh hadoop102 "/opt/module/hadoop-3.3.2/sbin/stop-dfs.sh"

;;

*)

  echo "Input Args Error..."

;;

esac<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>修改权限</p>
<pre class="line-numbers language-none"><code class="language-none">sudo chmod 777 myhadoop.sh<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>启动命令</p>
<pre class="line-numbers language-none"><code class="language-none">myhadoop.sh start

myhadoop.sh stop<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="13-4、全部jps脚本">13.4、全部jps脚本</h3>
<p>创建脚本到</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514221717361.png" alt="image-20220514221717361"></p>
<pre class="line-numbers language-none"><code class="language-none">#!/bin/bash

for host in hadoop102 hadoop103 hadoop104

do

    echo =============== $host ===============

    ssh $host jps 
done<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>修改权限和测试</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514222059834.png" alt="image-20220514222059834"></p>
<h1>四、hadoop端口和端口说明</h1>
<h2 id="1、常用端口说明">1、常用端口说明</h2>
<h3 id="1-1、hadoop3-x">1.1、hadoop3.x</h3>
<ul>
<li>HDFS NameNode内部通常端口:8020/9000/9820</li>
<li>HDFS NameNode 对用户的查询端口:9870</li>
<li>Yarn查看任务运行情况的:8088</li>
<li>历史服务器:19888</li>
</ul>
<h3 id="1-2、hadoop2-x">1.2、hadoop2.x</h3>
<ul>
<li>HDFS NameNode内部通常端口:8020/9000</li>
<li>HDFS NameNode对用户的查询端口:50070</li>
<li>Yarn查看任务运行情况的:8088</li>
<li>历史服务器:19888</li>
</ul>
<h3 id="2、采用配置文件">2、采用配置文件</h3>
<h4 id="3-x">3.x</h4>
<ul>
<li>core-site.xml</li>
<li>hdfs-site.xml</li>
<li>yarn-site.xml</li>
<li>mapred-site.xml</li>
<li>workers</li>
</ul>
<h4 id="2-x">2.x</h4>
<ul>
<li>core-site.xml</li>
<li>hdfs-site.xml</li>
<li>yarn-site.xml</li>
<li>mapred-site.xml</li>
<li>slaves</li>
</ul>
<h1>五、集群时间同步</h1>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514223818863.png" alt="image-20220514223818863"></p>
<p>生产环境:如果服务器能连接不了外网需要时间同步（需要时间同步）</p>
<h2 id="1、时间服务器配置（必须root用户，102）">1、时间服务器配置（必须root用户，102）</h2>
<h3 id="1-1、开启ntpd">1.1、开启ntpd</h3>
<p>1）查看状态</p>
<pre class="line-numbers language-none"><code class="language-none">systemctl status ntpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2）开启ntpd</p>
<pre class="line-numbers language-none"><code class="language-none">systemctl start ntpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>3）开机自启</p>
<pre class="line-numbers language-none"><code class="language-none">systemctl is-enabled ntpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="1-2、开启ntpd-conf">1.2、开启ntpd.conf</h3>
<pre class="line-numbers language-none"><code class="language-none">vim /etc/ntp.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>1）允许其他机器访问我</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514224623311.png" alt="image-20220514224623311"></p>
<p>2）不连接外部时间，用自己的时间</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514224743020.png" alt="image-20220514224743020"></p>
<p>3）添加配置</p>
<blockquote>
<p>当该节点丢失网络连接，依然可以采用本地时间作为时间服务器为集群中的其他节点提供时间同步</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">server 127.127.1.0
fudge 127.127.1.0 stratum 10<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514225128384.png" alt="image-20220514225128384"></p>
<h3 id="1-3、配置ntpd让硬件时间与系统时间一起同步">1.3、配置ntpd让硬件时间与系统时间一起同步)</h3>
<pre class="line-numbers language-none"><code class="language-none">vim /etc/sysconfig/ntpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>增加内容如下（让硬件时间与系统时间一起同步)</p>
<pre class="line-numbers language-none"><code class="language-none">SYNC_HWCLOCK=yes<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="2、配置其他机器">2、配置其他机器</h2>
<h3 id="1）关闭ntpd">1）关闭ntpd</h3>
<pre class="line-numbers language-none"><code class="language-none">sudo systemctl stop ntpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="2）开启不自启">2）开启不自启</h3>
<pre class="line-numbers language-none"><code class="language-none">sudo systemctl disable ntpd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h3 id="3）在其他机器配置1分钟与时间服务器同步一次">3）在其他机器配置1分钟与时间服务器同步一次</h3>
<pre class="line-numbers language-none"><code class="language-none">sudo crontab -e

*/1 * * * * /usr/sbin/ntpdate hadoop102<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h3 id="4）测试">4）测试</h3>
<pre class="line-numbers language-none"><code class="language-none">sudo date -s "2023-01-29 11:11:11"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>时间更新</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514230832604.png" alt="image-20220514230832604"></p>
<h1>六、<strong>常见错误及解决方案</strong></h1>
<p>1）防火墙没关闭、或者没有启动YARN</p>
<pre class="line-numbers language-none"><code class="language-none">INFO client.RMProxy: Connecting to ResourceManager at hadoop108/192.168.10.108:8032<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>2）主机名称配置错误</p>
<p>3）IP地址配置错误</p>
<p>4）ssh没有配置好</p>
<p>5）root用户和hadoop两个用户启动集群不统一</p>
<p>6）配置文件修改不细心</p>
<p>7）不识别主机名称</p>
<p>java.net.UnknownHostException: hadoop102: hadoop102</p>
<p>​    at java.net.InetAddress.getLocalHost(InetAddress.java:1475)</p>
<p>​    at org.apache.hadoop.mapreduce.JobSubmitter.submitJobInternal(JobSubmitter.java:146)</p>
<p>​    at org.apache.hadoop.mapreduce.Job$10.run(Job.java:1290)</p>
<p>​    at org.apache.hadoop.mapreduce.Job$10.run(Job.java:1287)</p>
<p>​    at java.security.AccessController.doPrivileged(Native Method)</p>
<p>at javax.security.auth.Subject.doAs(Subject.java:415)</p>
<p>解决办法：</p>
<p>（1）在/etc/hosts文件中添加192.168.10.102 hadoop102</p>
<p>​	（2）主机名称不要起hadoop  hadoop000等特殊名称</p>
<p>8）DataNode和NameNode进程同时只能工作一个。</p>
<p><img src="https://cdn.jsdelivr.net/gh/obeast-dragon/cloud-bed/pictures/image-20220514231315775.png" alt="image-20220514231315775"></p>
<p>9）执行命令不生效，粘贴Word中命令时，遇到-和长–没区分开。导致命令失效</p>
<p>解决办法：尽量不要粘贴Word中代码。</p>
<p>10）jps发现进程已经没有，但是重新启动集群，提示进程已经开启。</p>
<p>原因是在Linux的根目录下/tmp目录中存在启动的进程临时文件，将集群相关进程删除掉，再重新启动集群。</p>
<p>11）jps不生效</p>
<p>原因：全局变量hadoop java没有生效。解决办法：需要source /etc/profile文件。</p>
<p>12）8088端口连接不上</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@hadoop102 ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/hosts</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>注释掉如下代码</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment">#127.0.0.1  localhost localhost.localdomain localhost4 localhost4.localdomain4</span>

<span class="token comment">#::1     hadoop102</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">obeast-dragon</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://obeast-dragon.github.io/2021/08/01/hadoop/">https://obeast-dragon.github.io/2021/08/01/hadoop/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">obeast-dragon</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/hadoop/">
                                    <span class="chip bg-color">hadoop</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/11/01/springboot/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/14.jpg" class="responsive-img" alt="SpringBoot一条龙及整合中间件">
                        
                        <span class="card-title">SpringBoot一条龙及整合中间件</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-11-01
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/SpringBoot/" class="post-category">
                                    SpringBoot
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java/">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                    <a href="/tags/Spring/">
                        <span class="chip bg-color">Spring</span>
                    </a>
                    
                    <a href="/tags/SpringBoot/">
                        <span class="chip bg-color">SpringBoot</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/05/01/java-ban-she-ji-mo-shi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="设计模式学习">
                        
                        <span class="card-title">设计模式学习</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-05-01
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" class="post-category">
                                    设计模式
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">
                        <span class="chip bg-color">设计模式</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE' || selection.getRangeAt(0).commonAncestorContainer.nodeName === 'CODE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 社畜老龙的黄金屋<br />'
            + '文章作者: obeast-dragon<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1,h2, h3, h4, h5, h6'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="8814642553"
                   fixed='true'
                   autoplay='true'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='false'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2023</span>
            
            <a href="/about" target="_blank">obeast-dragon</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">176k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/obeast-dragon" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1468258057@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1468258057" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1468258057" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
